#include "utf8.h"

int utf_extra[] = {
  0xC4, 0xD6, 0xDC, 0xDF,
  0xE4, 0xF6, 0xFC, 0x1EDE,
  0x401, 0x451,
  0x2500, 0x2502, 0x250C, 0x2510,
  0x2514, 0x2518, 0x251C, 0x2524,
  0x252C, 0x2534, 0x253C, 0x2550,
  0x2551, 0x2552, 0x2553, 0x2554,
  0x2555, 0x2556, 0x2557, 0x2558,
  0x2559, 0x255A, 0x255B, 0x255C,
  0x255D, 0x255E, 0x255F, 0x2560,
  0x2561, 0x2562, 0x2563, 0x2564,
  0x2565, 0x2566, 0x2567, 0x2568,
  0x2569, 0x256A, 0x256B, 0x256C,
  0x2580, 0x2584, 0x2588, 0x258C,
  0x2590, 0x2591, 0x2592, 0x2593};

#define UTF_EXTRA_BOLD_SIZE 8
#define UTF_EXTRA_SIZE (sizeof(utf_extra) / sizeof(int))

int from_utf(unsigned u, char bold) {
  if (bold && u >= 0x21 && u <= 0x7E) return u - 0x21 + 0x7F;
  if (u <= 0x7E) return u;
  if (u >= 0x410 && u <= 0x44F) return u - 0x410 + 0xDD;
  for (int i = 0; i < UTF_EXTRA_SIZE; ++i) {
    if (utf_extra[i] == u) {
      if (bold && i < UTF_EXTRA_BOLD_SIZE)
        return 0x11D + UTF_EXTRA_SIZE + i;
      else
        return 0x11D + i;
    }
  }
  return -1;
}

int to_utf(unsigned v) {
  if (v <= 0x7E) return v;
  if (v >= 0x7F && v <= 0xDC) return v - 0x7F + 0x21;
  if (v >= 0xDD && v <= 0x11C) return v - 0xDD + 0x410;
  if (v >= 0x11D && v < 0x11D + UTF_EXTRA_SIZE) return utf_extra[v - 0x11D];
  if (v >= 0x11D + UTF_EXTRA_SIZE && v < 0x11D + UTF_EXTRA_SIZE + UTF_EXTRA_BOLD_SIZE) return utf_extra[v - 0x11D - UTF_EXTRA_SIZE];
  // Available: 0x15F - 0x1FF
  return -1;
}
